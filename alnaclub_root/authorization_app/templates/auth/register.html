{% extends "base.html" %}
{% load static %}

{% block title %}Register{% endblock %}

{% block content %}
<div class="container my-5">
    <h1 class="text-center mb-4">Sign Up</h1>
    <form method="post" id="registration-form">
        {% csrf_token %}

        <div class="form-label mb-3">
            {{ register_form.username.label_tag }}
            <input type="text" class="form-control custom-input" id="id_username" name="username">
        </div>

        <div class="form-label mb-3">
            {{ register_form.name.label_tag }}
            <input type="text" class="form-control custom-input" id="id_name" name="name">
        </div>

        <div class="form-label mb-3">
            {{ register_form.last_name.label_tag }}
            <input type="text" class="form-control custom-input" id="id_last_name" name="last_name">
        </div>

        <div class="form-label mb-3">
            {{ register_form.company_name.label_tag }}
            <input type="text" class="form-control custom-input" id="id_company_name" name="company_name">
        </div>

        <div class="form-label mb-3">
            {{ register_form.email.label_tag }}
            <input type="email" class="form-control custom-input" id="id_email" name="email">
        </div>

        <div class="form-label mb-3">
            {{ register_form.phone_number.label_tag }}
            <input type="text" class="form-control custom-input" id="id_phone_number" name="phone_number">
        </div>

        <div class="form-label mb-3">
            {{ register_form.address.label_tag }}
            <textarea class="form-control custom-input" id="id_address" name="address"></textarea>
        </div>

        <div class="form-label mb-3">
            {{ register_form.password1.label_tag }}
            <input type="password" class="form-control custom-input" id="id_password1" name="password1">
        </div>

        <div class="form-label mb-3">
            {{ register_form.password2.label_tag }}
            <input type="password" class="form-control custom-input" id="id_password2" name="password2">
        </div>

        <!-- Dropdown for Role Selection -->
        <div class="form-label mb-3">
            <label for="role" class="form-label">Select Role</label>
            {{ register_form.role }}
        </div>

        <!-- Role-Specific Fields -->
        <div id="investor-fields" class="role-specific">
            <div class="form-label mb-3">
                {{ register_form.occupation.label_tag }}
                <input type="text" class="form-control custom-input" id="id_occupation" name="occupation">
            </div>

            <div class="form-label mb-3">
                {{ register_form.ready_to_invest.label_tag }}
                <input type="number" class="form-control custom-input" id="id_ready_to_invest" name="ready_to_invest">
            </div>

            <div class="form-label mb-3">
                {{ register_form.return_goals.label_tag }}
                <textarea class="form-control custom-input" id="id_return_goals" name="return_goals"></textarea>
            </div>
        </div>

        <div id="developer-fields" class="role-specific">
            <div class="form-label mb-3">
                {{ register_form.projects_done.label_tag }}
                <input type="number" class="form-control custom-input" id="id_projects_done" name="projects_done">
            </div>
        </div>

        <div id="dual-fields" class="role-specific">
            <div class="form-label mb-3">
                {{ register_form.ssn.label_tag }}
                <input type="text" class="form-control custom-input" id="id_ssn" name="ssn">
            </div>
        </div>

        <button type="submit" class="btn btn-auth">Register</button>
    </form>
</div>

<script>
    function toggleFields() {
        const role = document.getElementById('id_role').value;
        document.querySelectorAll('.role-specific').forEach(section => {
            section.style.display = 'none';
        });
        if (role === 'Investor') {
            document.getElementById('investor-fields').style.display = 'block';
        } else if (role === 'Developer') {
            document.getElementById('developer-fields').style.display = 'block';
        } else if (role === 'Dual') {
            document.getElementById('dual-fields').style.display = 'block';
        }
    }

    // Ensure fields are toggled on page load
    document.addEventListener('DOMContentLoaded', toggleFields);

    // Add event listener for role changes
    document.getElementById('id_role').addEventListener('change', toggleFields);
</script>
{% endblock %}
